<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Registro Itália</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f4f4f4;
    }

    header {
      background-color: #ffffff;
      padding: 10px;
      display: flex;
      justify-content: center;
      align-items: center;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .logo {
      max-height: 100px;
    }

    .container {
      max-width: 900px;
      margin: 20px auto;
      padding: 20px;
      background-color: #fff;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    h1 {
      font-size: 24px;
      margin-bottom: 20px;
    }

    input[type="text"] {
      width: 100%;
      padding: 10px;
      font-size: 16px;
      border: 1px solid #ccc;
      border-radius: 4px;
      margin-bottom: 20px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
    }

    th,
    td {
      padding: 10px;
      border-bottom: 1px solid #ccc;
      text-align: left;
    }

    .whatsapp-link {
      display: inline-flex;
      align-items: center;
      color: #25d366;
      text-decoration: none;
    }

    .whatsapp-link svg {
      width: 20px;
      height: 20px;
      margin-right: 5px;
      fill: #25d366;
    }
  </style>
</head>

<body>
  <header>
    <img src="https://italiaregistro.com.br/wp-content/uploads/2023/03/cropped-logo-italia-registro-1.png" alt="Logo" class="logo" />
  </header>

  <div class="container">
    <h1>Busque seu registro de nascimento italiano</h1>
    <input type="text" id="busca" placeholder="Digite o nome ou comuna" />
    <div id="resultados"></div>
  </div>

  <script>
    const buscaInput = document.getElementById("busca");
    const resultados = document.getElementById("resultados");

    let dados = [];

    async function carregarDados() {
      try {
        const resposta = await fetch("https://italiaregistro.com.br/dados/dados.json");
        dados = await resposta.json();
      } catch (erro) {
        resultados.innerHTML = `<p>Erro ao carregar os dados.</p>`;
      }
    }

    function buscarRegistros(termo) {
      const termoLower = termo.toLowerCase();
      return dados.filter(item =>
        item.Nome.toLowerCase().includes(termoLower) ||
        item.Comuna.toLowerCase().includes(termoLower)
      );
    }

    function exibirResultados(resultadosBusca) {
      if (resultadosBusca.length === 0) {
        resultados.innerHTML = `<p>Nenhum registro encontrado.</p>`;
        return;
      }

      let html = `<table>
        <tr>
          <th>Nome</th>
          <th>Data de nascimento</th>
          <th>Comuna</th>
          <th>Contato</th>
        </tr>`;

      resultadosBusca.forEach(({ Nome: nome, Data: data, Comuna: comuna }) => {
        const textoWhatsApp = `Olá! Gostaria de solicitar o registro de nascimento de ${nome}, nascido em ${data} na comuna de ${comuna}.`;
        const urlWhatsApp = `https://wa.me/5545920027919?text=${encodeURIComponent(textoWhatsApp)}`;

        html += `
          <tr>
            <td>${nome}</td>
            <td>${data}</td>
            <td>${comuna}</td>
            <td><a href="${urlWhatsApp}" target="_blank" rel="noopener" class="whatsapp-link">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
                <path d="M380.9 97.1C339-4.3 221.1-31.6 135.2 31.4 88.1 67.6 60.6 120.9 64.1 177.7c.2 7.1-1.8 14.1-5.8 20.1L26.6 264.4c-8.1 12-5.2 28.3 6.5 36.9l67.2 49.3c5.4 4 12.1 6.2 18.8 6.2 2.7 0 5.4-.4 8-1.2 6.4-2 13.2-.2 17.9 4.7l42.2 42.8c9.5 9.6 24.4 12.3 36.6 6.6l70.7-33.3c7.4-3.5 15.3-5.3 23.4-5.3 50.8 0 97.3-29.3 118.8-76.1 33.9-73.8 3.6-160.6-66.8-196.9z" />
              </svg>
              <span>Solicitar orçamento</span>
            </a></td>
          </tr>`;
      });

      html += `</table>`;
      resultados.innerHTML = html;
    }

    buscaInput.addEventListener("input", () => {
      const termo = buscaInput.value.trim();
      if (termo.length > 2) {
        const encontrados = buscarRegistros(termo);
        exibirResultados(encontrados);
      } else {
        resultados.innerHTML = "";
      }
    });

    carregarDados();
  </script>
</body>

</html>
